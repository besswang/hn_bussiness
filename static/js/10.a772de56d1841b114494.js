webpackJsonp([10],{"5zde":function(e,t,a){a("zQR9"),a("qyJz"),e.exports=a("FeBl").Array.from},Gu7T:function(e,t,a){"use strict";t.__esModule=!0;var o,s=a("c/Tr"),r=(o=s)&&o.__esModule?o:{default:o};t.default=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return(0,r.default)(e)}},"c/Tr":function(e,t,a){e.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(e,t,a){"use strict";var o=a("evD5"),s=a("X8DO");e.exports=function(e,t,a){t in e?o.f(e,t,s(0,a)):e[t]=a}},"i8+o":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("Gu7T"),s=a.n(o),r=(a("ylrw"),a("+BTi"),a("6oiW")),i=a.n(r),n=(a("Dte2"),a("q4le")),l=a.n(n),c=(a("isE6"),a("LR6y")),d=a.n(c),g=(a("8jhb"),a("RDoK")),m=a.n(g),u=(a("BNJR"),a("fDPO")),h=a.n(u),f=(a("X+ky"),a("HJMx")),p=a.n(f),y=(a("cDSy"),a("e0Bm")),v=a.n(y),w=(a("I4nB"),a("STLj")),C=a.n(w),S=(a("+Rdb"),a("Mezo")),_=a.n(S),b=(a("qunJ"),a("vqwl")),M=a.n(b),k=(a("Yq4J"),a("qubY")),F=a.n(k),$=(a("M9yL"),a("OSLW")),I=a.n($),x=(a("/i/W"),a("V1RD")),E=a.n(x),N=(a("GXEp"),a("mtrD")),D=a.n(N),T=(a("jZDA"),a("91Nw")),U=a.n(T),z=(a("d7TW"),a("ajQY")),G=a.n(z),L=a("woOf"),A=a.n(L),R=a("c/Tr"),j=a.n(R);var q={name:"product_classify",components:{"el-row":G.a,"el-col":U.a,"el-button":D.a,"el-breadcrumb":E.a,"el-breadcrumb-item":I.a,"el-dialog":F.a,"el-form":M.a,"el-form-item":_.a,"el-option":C.a,"el-select":v.a,"el-input":p.a,"el-radio-group":h.a,"el-radio":m.a,"el-table":d.a,"el-table-column":l.a,"el-pagination":i.a},data:function(){return{loadUse:!1,pageNum:1,pageSize:5,total:0,dialogRelevance:!1,goodsMerchantCategoryId:"",gridData:[],myForm:{id:"",categoryId:"0",categoryName:"",dpath:"",showState:""},rules:{categoryName:[{required:!0,message:"请输入分类名，最多20个字",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类名称",trigger:"blur click"}],showState:[{required:!0,message:"请选择显示状态",trigger:"click"}]},myColumn:[{label:"选择",width:"100",rowName:"index"},{label:"分类名",rowName:"name"},{label:"是否显示",rowName:"isShow"},{label:"操作",width:"240",rowName:"id"}],oneCategoryList:[],isShowDialog:!1,loading:!1,allcCategoriesList:[],isEditState:!1,isDisabled:!1}},methods:{handleSizeChange:function(e){this.pageSize=e,this.relevanceFn(this.goodsMerchantCategoryId)},handleCurrentChange:function(e){this.pageNum=e,this.relevanceFn(this.goodsMerchantCategoryId)},deleteRow:function(e){var t=this;this.$axios.post(this.$$jk.removeGoodsFromGoodsMerchantCategory,{goodsId:e,goodsMerchantCategoryId:this.goodsMerchantCategoryId}).then(function(e){"SUCCESS"==e.data.code?(t.$message({message:"删除成功",type:"SUCCESS"}),t.relevanceFn(t.goodsMerchantCategoryId)):t.$message({message:e.data.remark,type:"warning"})}).catch(function(e){alert(e)})},relevanceFn:function(e){var t=this;this.goodsMerchantCategoryId=e,this.$axios.post(this.$$jk.getMerchantCategoriesGoods,{merchantCategoriesId:e,pageNum:this.pageNum,pageSize:this.pageSize}).then(function(e){if("SUCCESS"==e.data.code){t.dialogRelevance=!0;var a=e.data.data;t.total=a.total,t.gridData=a.list}else t.$message({message:e.data.remark,type:"warning"})}).catch(function(e){alert(e)})},showTrMt:function(e){return 0!=e.row.parentId&&0==e.row.isExend?"display:none":""},handleTreeMt:function(e){var t=e.row.child[0].isExend;Array.isArray(e.row.child)&&e.row.child.forEach(function(e,a,o){e.isExend=!t})},getOneCategoriesMt:function(){var e=this;this.$axios.post("oneCategory").then(function(t){t&&t.data&&"SUCCESS"==t.data.code?e.oneCategoryList=t.data.data:e.$message({message:t.data.remark,type:"warning"})}).catch(function(e){console.log(e)})},submitFormMt:function(e){var t=this,a=this.myForm,o="",s={};if(this.isEditState){if(o=this.$$jk.goodsCategoriesUpdate,!(this.myForm&&this.myForm.categoryId>-1))return void this.$message({message:"父级分类id不存在"});s={parentId:this.myForm.categoryId,id:this.myForm.id,isShow:a.showState,name:a.categoryName}}else o=this.$$jk.goodsCategoriesSave,s={parentId:"顶级分类"==a.categoryId?0:a.categoryId,isShow:a.showState,name:a.categoryName};""!=o&&this.$refs[e].validate(function(e){e&&t.$axios.post("flag",s).then(function(e){e&&e.data&&"SUCCESS"==e.data.code?(t.$message({message:t.isEditState?"修改成功":"添加成功",type:"success"}),t.isShowDialog=!1,t.isEditState=!1,console.log(t.myForm.categoryId),t.allcCategoriesList.push({name:t.myForm.categoryId})):t.$message({message:e.data.remark,type:"warning"})}).catch(function(e){console.log(e)})})},cancelFormMt:function(e){this.isShowDialog=!1,this.$refs[e].resetFields()},getAllGoodsMerchantCategoriesMt:function(){var e=sessionStorage.getItem("merchantId"),t=this;Number(e)>-1?this.$axios.post("getAllGoodsMerchantCategories",{storeId:e}).then(function(e){if(e&&e.data&&"SUCCESS"==e.data.code){var a,o=[];e.data.data.forEach(function(e,t,a){var s={};(s=e.goodsMerchantCategories).child=e.goodsMerchantCategoriesList,o.push(s)}),(a=t.allcCategoriesList).push.apply(a,s()(function e(t){var a=[];return j()(t).forEach(function(t){if(a.push(t),0!=t.parentId&&(t=A()(t,{isExend:!1})),t.child&&t.child.length>0){var o=e(t.child);a=a.concat(o)}}),a}(o)))}else t.$message({message:e.data.remark,type:"warning"});setTimeout(function(){t.loadUse=!1},500)}).catch(function(e){console.log(e)}):this.$message({message:"merchantId未获取到",type:"error"})},addCategoriesListMt:function(){this.isShowDialog=!0,this.isDisabled=!1,this.myForm={categoryId:"顶级分类",categoryName:"",showState:""},this.getOneCategoriesMt(),this.isEditState=!1},editCategoriesListMt:function(e){var t=this;this.isShowDialog=!0,this.isDisabled=1==e.row.dpath,this.getOneCategoriesMt(),this.isEditState=!0,this.$axios.post(this.$$jk.getGoodsMerCate,{id:e.row.id}).then(function(e){if(e&&e.data&&"SUCCESS"==e.data.code){var a=e.data.data;t.myForm={id:a.id,categoryId:a.parentId,categoryName:a.name,showState:a.isShow}}else t.$message({message:e.data.remark,type:"warning"})}).catch(function(e){console.log(e)})},delFirstGoodsMerchantCategoriesMt:function(e){var t=this,a=1==e.row.dpath?this.$$jk.delFirstGoodsMerchantCategories:this.$$jk.delSecondGoodsMerchantCategories;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loadUse=!0,t.$axios.post(a,{goodsMerchantCategoriesId:e.row.id}).then(function(e){e&&e.data&&"SUCCESS"==e.data.code?(t.$message({type:"success",message:"删除成功!"}),t.getAllGoodsMerchantCategoriesMt()):t.$message({message:e.data.remark,type:"warning"})}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},chanegCategoryMt:function(e){e&&(this.myForm.categoryId=e)}},created:function(){this.$store.state.adminleftnavnum="/product_category"},mounted:function(){this.loadUse=!0,this.getAllGoodsMerchantCategoriesMt()}},B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"category"},[a("div",{staticClass:"source"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("商家中心")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品分类")])],1)],1),e._v(" "),a("div",{staticClass:"add-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addCategoriesListMt()}}},[e._v("添加分类")])],1),e._v(" "),a("el-dialog",{attrs:{title:(e.isEditState?"编辑":"添加")+"商品分类",visible:e.isShowDialog,modal:!1},on:{"update:visible":function(t){e.isShowDialog=t}}},[e.isShowDialog?[a("el-form",{ref:"myForm",attrs:{model:e.myForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"父级分类",prop:"categoryId"}},[a("el-select",{attrs:{disabled:e.isDisabled,placeholder:"请选择活动区域"},on:{change:e.chanegCategoryMt},model:{value:e.myForm.categoryId,callback:function(t){e.$set(e.myForm,"categoryId",t)},expression:"myForm.categoryId"}},[a("el-option",{key:0,attrs:{value:0,label:"顶级分类"}}),e._v(" "),e._l(e.oneCategoryList,function(e){return a("el-option",{key:e.id,attrs:{value:e.name,label:e.name}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"分类名",prop:"categoryName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.myForm.categoryName,callback:function(t){e.$set(e.myForm,"categoryName",t)},expression:"myForm.categoryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"展示",prop:"showState"}},[a("el-radio-group",{model:{value:e.myForm.showState,callback:function(t){e.$set(e.myForm,"showState",t)},expression:"myForm.showState"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:function(t){e.cancelFormMt("myForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitFormMt("myForm")}}},[e._v("确 定")])],1)],1)]:e._e()],2),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadUse,expression:"loadUse"}],staticStyle:{width:"100%"},attrs:{data:e.allcCategoriesList,border:"","row-style":e.showTrMt}},e._l(e.myColumn,function(t,o){return a("el-table-column",{key:o,attrs:{width:t.width,label:t.label},scopedSlots:e._u([{key:"default",fn:function(o){return["index"==t.rowName?[1==o.row.dpath?[o.row.child.length?[a("span",{staticClass:"openTree",on:{click:function(t){e.handleTreeMt(o)}}},[e._v("+")])]:[a("span",{staticClass:"openTree"},[e._v("-")])]]:e._e(),e._v(" "),2==o.row.dpath?[a("span",{staticClass:"openTree",staticStyle:{"margin-left":"28px"}},[e._v("-")])]:e._e()]:e._e(),e._v(" "),"name"==t.rowName?[e._v("\n        "+e._s(o.row.name)+"\n      ")]:e._e(),e._v(" "),"isShow"==t.rowName?[e._v("\n        "+e._s(o.row.isShow?"是":"否")+"\n      ")]:e._e(),e._v(" "),"id"==t.rowName?[1==o.row.dpath?[a("span",{staticClass:"linkCur",on:{click:function(t){e.editCategoriesListMt(o)}}},[e._v("编辑")]),e._v(" "),a("span",{staticClass:"linkCur",on:{click:function(t){e.delFirstGoodsMerchantCategoriesMt(o)}}},[e._v("删除")])]:e._e(),e._v(" "),2==o.row.dpath?[a("span",{staticClass:"linkCur",on:{click:function(t){e.editCategoriesListMt(o)}}},[e._v("编辑")]),e._v(" "),a("span",{staticClass:"linkCur",on:{click:function(t){e.delFirstGoodsMerchantCategoriesMt(o)}}},[e._v("删除")]),e._v(" "),a("span",{staticClass:"linkCur",on:{click:function(t){e.relevanceFn(o.row.id)}}},[e._v("已关联的商品")])]:e._e()]:e._e()]}}])})})),e._v(" "),a("el-dialog",{attrs:{title:"关联商品分类",visible:e.dialogRelevance,width:"60%"},on:{"update:visible":function(t){e.dialogRelevance=t}}},[a("el-table",{attrs:{data:e.gridData}},[a("el-table-column",{attrs:{prop:"goodsImage",label:"展示图"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{"max-height":"60px"},attrs:{src:e.row.goodsImage,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"name",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{property:"price",label:"价格"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stocks",property:"stocks",label:"库存"}}),e._v(" "),a("el-table-column",{attrs:{prop:"addTime",width:"200",label:"上架/下架时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isShow",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(1==t.row.isShow?"上架":0==t.row.isShow?"下架":"待上架"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger"},nativeOn:{click:function(a){a.preventDefault(),e.deleteRow(t.row.id)}}},[e._v("移除")])]}}])})],1),e._v(" "),a("div",{staticStyle:{padding:"15px"}},[a("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[5,10,15,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var O=a("VU/8")(q,B,!1,function(e){a("kUVE")},"data-v-3ff8ffd9",null);t.default=O.exports},kUVE:function(e,t){},qyJz:function(e,t,a){"use strict";var o=a("+ZMJ"),s=a("kM2E"),r=a("sB3e"),i=a("msXi"),n=a("Mhyx"),l=a("QRG4"),c=a("fBQ2"),d=a("3fs2");s(s.S+s.F*!a("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,s,g,m=r(e),u="function"==typeof this?this:Array,h=arguments.length,f=h>1?arguments[1]:void 0,p=void 0!==f,y=0,v=d(m);if(p&&(f=o(f,h>2?arguments[2]:void 0,2)),void 0==v||u==Array&&n(v))for(a=new u(t=l(m.length));t>y;y++)c(a,y,p?f(m[y],y):m[y]);else for(g=v.call(m),a=new u;!(s=g.next()).done;y++)c(a,y,p?i(g,f,[s.value,y],!0):s.value);return a.length=y,a}})}});
//# sourceMappingURL=10.a772de56d1841b114494.js.map